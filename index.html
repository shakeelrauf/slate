
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>SDHPAY API Reference</title>

    <style media="screen">
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s, .highlight .sa, .highlight .dl {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf, .highlight .fm {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv, .highlight .vm {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .nl {
  color: #f92672;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <style media="print">
      * {
        -webkit-transition:none!important;
        transition:none!important;
      }
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #586e75;
}
.highlight .err {
  color: #002b36;
  background-color: #dc322f;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cm, .highlight .cpf, .highlight .c1, .highlight .cs {
  color: #657b83;
}
.highlight .cp {
  color: #b58900;
}
.highlight .nt {
  color: #b58900;
}
.highlight .o, .highlight .ow {
  color: #93a1a1;
}
.highlight .p, .highlight .pi {
  color: #93a1a1;
}
.highlight .gi {
  color: #859900;
}
.highlight .gd {
  color: #dc322f;
}
.highlight .gh {
  color: #268bd2;
  background-color: #002b36;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #6c71c4;
}
.highlight .kc {
  color: #cb4b16;
}
.highlight .kt {
  color: #cb4b16;
}
.highlight .kd {
  color: #cb4b16;
}
.highlight .s, .highlight .sa, .highlight .sb, .highlight .sc, .highlight .dl, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #859900;
}
.highlight .sr {
  color: #2aa198;
}
.highlight .si {
  color: #d33682;
}
.highlight .se {
  color: #d33682;
}
.highlight .nn {
  color: #b58900;
}
.highlight .nc {
  color: #b58900;
}
.highlight .no {
  color: #b58900;
}
.highlight .na {
  color: #268bd2;
}
.highlight .m, .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mx {
  color: #859900;
}
.highlight .ss {
  color: #859900;
}
    </style>
    <link href="stylesheets/screen-1bc95bb3.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-953e3353.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-e9bde216.js"></script>

    <script>
      $(function() { setupCodeCopy(); });
    </script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar-cad8cdcb.png" alt="" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo-71d09c50.png" class="logo" alt="" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#another-pay-recurring-payments" class="toc-h1 toc-link" data-title="Another Pay – Recurring Payments">Another Pay – Recurring Payments</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#setting-up-recurring-payments" class="toc-h2 toc-link" data-title="Setting Up Recurring Payments">Setting Up Recurring Payments</a>
                  </li>
                  <li>
                    <a href="#automatic-monthly-subscription-payment" class="toc-h2 toc-link" data-title="Automatic monthly subscription payment">Automatic monthly subscription payment</a>
                  </li>
                  <li>
                    <a href="#enable-recurring-payment-form-field" class="toc-h2 toc-link" data-title="Enable Recurring Payment Form Field">Enable Recurring Payment Form Field</a>
                  </li>
                  <li>
                    <a href="#recurring-payment-token" class="toc-h2 toc-link" data-title="Recurring Payment Token">Recurring Payment Token</a>
                  </li>
                  <li>
                    <a href="#making-a-recurring-payment" class="toc-h2 toc-link" data-title="Making a Recurring Payment">Making a Recurring Payment</a>
                  </li>
                  <li>
                    <a href="#cancelling-recurring-payments" class="toc-h2 toc-link" data-title="Cancelling Recurring Payments">Cancelling Recurring Payments</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#server-to-server-integeration" class="toc-h1 toc-link" data-title="Server to Server Integeration">Server to Server Integeration</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#step-1-collect-card-details" class="toc-h2 toc-link" data-title="Step 1 - Collect Card Details">Step 1 - Collect Card Details</a>
                  </li>
                  <li>
                    <a href="#step-2-encrypt-card-details" class="toc-h2 toc-link" data-title="Step 2 - Encrypt Card Details">Step 2 - Encrypt Card Details</a>
                  </li>
                  <li>
                    <a href="#step-3-initiate-payment" class="toc-h2 toc-link" data-title="Step 3 - Initiate Payment">Step 3 - Initiate Payment</a>
                  </li>
                  <li>
                    <a href="#step-4-handling-authentication-models" class="toc-h2 toc-link" data-title="Step 4 - Handling Authentication Models">Step 4 - Handling Authentication Models</a>
                  </li>
                  <li>
                    <a href="#step-5-payment-processing" class="toc-h2 toc-link" data-title="Step 5 - Payment Processing">Step 5 - Payment Processing</a>
                  </li>
                  <li>
                    <a href="#step-6-callback-urls" class="toc-h2 toc-link" data-title="Step 6 - Callback URLs">Step 6 - Callback URLs</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#form-parameter-definitions" class="toc-h1 toc-link" data-title="Form Parameter Definitions">Form Parameter Definitions</a>
          </li>
          <li>
            <a href="#test-cards" class="toc-h1 toc-link" data-title="Test Cards">Test Cards</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#test-cards-2" class="toc-h2 toc-link" data-title="Test Cards">Test Cards</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#customized-plugins" class="toc-h1 toc-link" data-title="Customized Plugins">Customized Plugins</a>
          </li>
          <li>
            <a href="#errors" class="toc-h1 toc-link" data-title="Errors">Errors</a>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='#'>Sign Up for a Developer Key</a></li>
            <li><a href='https://github.com/slatedocs/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='another-pay-recurring-payments'>Another Pay – Recurring Payments</h1>
<p>Here is a draft specification for recurring payments
The images shown in this document are for illustration only.  They don’t represent final designs.</p>
<h2 id='setting-up-recurring-payments'>Setting Up Recurring Payments</h2>
<p>A checkbox is added to the Check Out screen.  Selecting <code>Automatic monthly subscription payment</code> will turn on monthly billing for the subscription.</p>

<p><img src="images/recurring1-1c14773c.jpg"></p>
<h2 id='automatic-monthly-subscription-payment'>Automatic monthly subscription payment</h2>
<p>The monthly billing will be initiated for each user by the user’s system.  This will be done monthly and the amount to be billed will be submitted to Another Pay.
<br>
This monthly amount to be billed will be submitted along with a token provided by Another Pay.  Any taxes and fees will be included in the billing amount.</p>
<h2 id='enable-recurring-payment-form-field'>Enable Recurring Payment Form Field</h2>
<p>A new form field for recurring payments is to be sent when a purchase is made.
<br><br>
<code>true = initiate recurring payments</code>
<br>
<code>false = do not initiate recurring payments</code></p>
<h3 id='example'>Example:</h3>
<p><code>&lt;input type=”hidden” name=”enablerecurring” value=”true”&gt;</code>
<br>
Or
<br>
<code>&lt;input type=”hidden” name=” enablerecurring” value=”false”&gt;</code></p>
<h2 id='recurring-payment-token'>Recurring Payment Token</h2>
<p>When <b>enablerecurring</b> is true, then Another Pay will return a token for recurring payments to the AboveGem System as part of the POST Notification request.</p>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"id"</span><span class="p">:</span><span class="w">  </span><span class="mi">45</span><span class="p">,</span><span class="w">
    </span><span class="nl">"code"</span><span class="p">:</span><span class="w">  </span><span class="s2">"1232"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"availed"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"recurringbilling"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abc123efg456"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p><br>
This token will be used when submitting recurring payments.</p>
<h2 id='making-a-recurring-payment'>Making a Recurring Payment</h2>
<p>Making a recurring payment will be performed automatically by the users system when payment is due and recurring billing is enabled.<br>
<br>
Example:
<code>&lt;input type=”hidden” name=”recurringbilling” value=”true”&gt;</code>
<br>
<code>&lt;input type=”hidden” name=”token” value=” abc123efg456”&gt;</code>
<br>
OR
<br>
<code>&lt;input type=”hidden” name=”recurringbilling” value=”false”&gt;</code>
<br>
The user is not presented with a user interface, therefore only an HTTP response with success / failure should be returned.</p>

<blockquote>
<p>For Example:</p>

<p>Success:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
</span><span class="nl">"id"</span><span class="p">:</span><span class="w">  </span><span class="mi">45</span><span class="p">,</span><span class="w">
</span><span class="nl">"code"</span><span class="p">:</span><span class="w">  </span><span class="s2">"1232"</span><span class="p">,</span><span class="w">
</span><span class="nl">"availed"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>Failure:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
</span><span class="nl">"id"</span><span class="p">:</span><span class="w">  </span><span class="kc">null</span><span class="p">,</span><span class="w">
</span><span class="nl">"code"</span><span class="p">:</span><span class="w">  </span><span class="s2">"1232"</span><span class="p">,</span><span class="w">
</span><span class="nl">"availed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h2 id='cancelling-recurring-payments'>Cancelling Recurring Payments</h2>
<p>To Cancel a recurring payment, the user will go to their profile in the user system.  Cancelling simply deletes the token and users will need to make future payments manually.</p>

<p><img src="images/recurring2-46a2ea3f.jpg"></p>
<h1 id='server-to-server-integeration'>Server to Server Integeration</h1><h2 id='step-1-collect-card-details'>Step 1 - Collect Card Details</h2>
<blockquote>
<p>Collect card details to collect from the customer:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
</span><span class="nl">"PBFPubKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;PUBLIC_KEY&gt;"</span><span class="p">,</span><span class="w">
</span><span class="nl">"cardno"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4187427415564246"</span><span class="p">,</span><span class="w">
</span><span class="nl">"cvv"</span><span class="p">:</span><span class="w"> </span><span class="s2">"828"</span><span class="p">,</span><span class="w">
</span><span class="nl">"expirymonth"</span><span class="p">:</span><span class="w"> </span><span class="s2">"09"</span><span class="p">,</span><span class="w">
</span><span class="nl">"expiryyear"</span><span class="p">:</span><span class="w"> </span><span class="s2">"21"</span><span class="p">,</span><span class="w">
</span><span class="nl">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USD"</span><span class="p">,</span><span class="w">
</span><span class="nl">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NG"</span><span class="p">,</span><span class="w">
</span><span class="nl">"amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10"</span><span class="p">,</span><span class="w">
</span><span class="nl">"txRef"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test-1-12344321"</span><span class="p">,</span><span class="w">
</span><span class="nl">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"maestrojolly@gmail.com"</span><span class="p">,</span><span class="w"> 
</span><span class="nl">"phonenumber"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0902620185"</span><span class="p">,</span><span class="w">
</span><span class="nl">"firstname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"maestro"</span><span class="p">,</span><span class="w">
</span><span class="nl">"lastname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jolly"</span><span class="p">,</span><span class="w">
</span><span class="nl">"IP"</span><span class="p">:</span><span class="w"> </span><span class="s2">"355426087298442"</span><span class="p">,</span><span class="w">
</span><span class="nl">"billingzip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"07205"</span><span class="p">,</span><span class="w">
</span><span class="nl">"billingcity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hillside"</span><span class="p">,</span><span class="w">
</span><span class="nl">"billingaddress"</span><span class="p">:</span><span class="w"> </span><span class="s2">"470 Mundet PI"</span><span class="p">,</span><span class="w">
</span><span class="nl">"billingstate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NJ"</span><span class="p">,</span><span class="w">
</span><span class="nl">"billingcountry"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US"</span><span class="p">,</span><span class="w">
</span><span class="nl">"redirect_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;BASE_URL&gt;​/validate_payment​"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h3 id='http-request'>HTTP Request</h3><h3 id='live-base_url'>Live BASE_URL:</h3>
<p><code>https://sdhpay.online</code></p>
<h3 id='live-public_key'>Live PUBLIC_KEY:​</h3>
<p><code>“FLWPUBK-92748e012bd4dc92df617a7e64bae136-X”</code></p>
<h3 id='staging-base_url'>Staging BASE_URL:</h3>
<p><code>​http://evoucher.mashup.li</code></p>
<h3 id='staging-public_key'>Staging PUBLIC_KEY:​</h3>
<p><code>“FLWPUBK-7c41221d0852ae66fb2c42a070a38dd1-X”</code></p>

<aside class="success">
Remember — You should be authenticated!
</aside>
<h2 id='step-2-encrypt-card-details'>Step 2 - Encrypt Card Details</h2><h3 id='encrypt-the-details-and-generate-a-secure-key-pass-the-data-hash-collected-in-step-1-and-secret-key-to-encrypt-the-request-parameters-for-details-refer-to-encryption-docs'>Encrypt the details and generate a secure key. Pass the ​data hash collected in Step 1 and ​secret key​ to encrypt the request parameters. For details refer to ​encryption docs​.</h3>
<p>The secret key will be sent to you via mail</p>
<h2 id='step-3-initiate-payment'>Step 3 - Initiate Payment</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">--request</span> POST <span class="se">\</span>
<span class="nt">--url</span> &lt;BASE_URL&gt;/initiate <span class="se">\</span>
<span class="nt">--header</span> <span class="s1">'content-type: application/json'</span> <span class="se">\ </span><span class="nt">--data</span>
‘<span class="o">{</span> “encrypted_data”: “”, “payment_redirect_url”: “”, 
  “payment_notification_url”: “”, “orderreference”: “” ,
   “email”: “”, <span class="s2">"amount"</span>: <span class="s2">"10"</span>, <span class="s2">"currency"</span>: <span class="s2">"NGN"</span><span class="o">}</span>’
</code></pre></div><h3 id='http-request-2'>HTTP Request</h3>
<p><code>GET &lt;BASE_URL&gt;/initiate</code></p>
<h3 id='url-parameters'>URL Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Definition</th>
</tr>
</thead><tbody>
<tr>
<td>encrypted_data</td>
<td>This is the encrypted request parameters</td>
</tr>
<tr>
<td>payment_redirect_url</td>
<td>URL user will be redirect to after payment is processed. Result will be sent along as query params</td>
</tr>
<tr>
<td>payment_notification_url</td>
<td>Route where we will send transaction result</td>
</tr>
<tr>
<td>orderreference</td>
<td>Unique orderreference assigned</td>
</tr>
<tr>
<td>amount</td>
<td>Total amount that user will be charged</td>
</tr>
<tr>
<td>currency</td>
<td>Currency the amount will be paid in. EUR, GBP, USD, NGN</td>
</tr>
</tbody></table>
<h3 id='be-sure-to-specify'>Be sure to specify:</h3>
<p>orderreference​ needs to have the prefix ​MERCHANT_UNIQUE_IDENTIFIER​ (for example: SJH2000-19-11791-11791)</p>
<h3 id='currently-with-this-api-you-can-charge-the-following-cards'>Currently, with this API, you can charge the following cards:</h3>
<p>● Local (Nigerian)Mastercards, Verve cards, and Visa Cards<br>
 ● International Cards — Mastercards and Visa Card</p>
<h3 id='response-depends-on-the-authentication-model-of-the-card'>Response depends on the authentication model of the card</h3>
<p>● PIN and OTP
<br>● 3DSecure
<br>● AVS</p>

<p>In case the card has some authentication model set the response will be json</p>
<h3 id='3d-secure-example'>3D SECURE (example):</h3>
<p><code>
{
  message: “”,
  authurl:“http://flw-pms-dev.eu-west-1.elasticbeanstalk.com/mockvbvpage?ref=FL W-MOCK-a71d1de9130a1e221720ef52456943e5&amp;code=00&amp;message=Approved. Successful”,
  suggested_auth: “auth_url” 
}
</code></p>
<h3 id='when-received-this-just-redirect-user-to-the-url-provided-in-authurl'>When received this just redirect user to the url provided in ​authurl.</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Definition</th>
</tr>
</thead><tbody>
<tr>
<td>authurl</td>
<td>Authurl will only be sent for 3D Secure cards it will me empty in case of other authentication models</td>
</tr>
<tr>
<td>suggested_auth</td>
<td>suggested_auth can be one of these 4 <br> ● auth_url <br> ● pin <br> ● otp <br>● avs <br><code>The next steps for each are mentioned later in the document</code>.</td>
</tr>
<tr>
<td>message</td>
<td>Description of what is required from user</td>
</tr>
</tbody></table>
<h2 id='step-4-handling-authentication-models'>Step 4 - Handling Authentication Models</h2><h3 id='pin-and-otp'>PIN and OTP​:</h3>
<p>With this response, the obvious next step is to prompt your user to enter his/her card pin.
After the user enters his/her pin, you need to:
<ol>
  <li>
     Update your payload with the pin entered. Your payload will look something like this <br>
  </li>
  <li>
    Once your payload has been updated, you need to re-encrypt it and call the charge endpoint as in step 1 above.
  </li>
</ol></p>
<div class="highlight"><pre class="highlight shell tab-shell"><code><span class="o">{</span>
  <span class="s2">"PBFPubKey"</span> <span class="o">=&gt;</span> &lt;PUBLIC_KEY&gt;, “suggested_auth” <span class="o">=&gt;</span> “pin”,
  “pin” <span class="o">=&gt;</span> “1234”,
  <span class="s2">"cardno"</span> <span class="o">=&gt;</span> <span class="s2">"4187427415564246"</span>,
  <span class="s2">"cvv"</span> <span class="o">=&gt;</span> <span class="s2">"828"</span>,
  <span class="s2">"expirymonth"</span> <span class="o">=&gt;</span> <span class="s2">"09"</span>,
  <span class="s2">"expiryyear"</span> <span class="o">=&gt;</span> <span class="s2">"21"</span>,
  <span class="s2">"currency"</span> <span class="o">=&gt;</span> <span class="s2">"USD"</span>,
  <span class="s2">"country"</span> <span class="o">=&gt;</span> <span class="s2">"NG"</span>,
  <span class="s2">"amount"</span> <span class="o">=&gt;</span> <span class="s2">"10"</span>,
  <span class="s1">'txRef'</span> <span class="o">=&gt;</span> <span class="s1">'test-1-12344321'</span>,
  <span class="s2">"email"</span> <span class="o">=&gt;</span> <span class="s2">"maestrojolly@gmail.com"</span>, <span class="s2">"phonenumber"</span> <span class="o">=&gt;</span> <span class="s2">"0902620185"</span>,
  <span class="s2">"firstname"</span> <span class="o">=&gt;</span> <span class="s2">"maestro"</span>,
  <span class="s2">"lastname"</span> <span class="o">=&gt;</span> <span class="s2">"jolly"</span>,
  <span class="s2">"IP"</span> <span class="o">=&gt;</span> <span class="s2">"355426087298442"</span>,
  <span class="s2">"billingzip"</span>: <span class="s2">"07205"</span>,
  <span class="s2">"billingcity"</span>: <span class="s2">"Hillside"</span>,
  <span class="s2">"billingaddress"</span>: <span class="s2">"470 Mundet PI"</span>,
  <span class="s2">"billingstate"</span>: <span class="s2">"NJ"</span>,
  <span class="s2">"billingcountry"</span>: <span class="s2">"US"</span>,
  <span class="s2">"redirect_url"</span>: <span class="s2">"&lt;BASE_URL&gt;​/validate_payment​"</span>
<span class="o">}</span>

</code></pre></div><h3 id='once-2-is-done-you-should-get-a-response-like-the-one-shown-below-requesting-that-the-user-enters-an-otp-sent-to-his-her-phone-number'>Once #2 is done, you should get a response (like the one shown below) requesting that the user enters an OTP sent to his/her phone number.</h3>
<p><br>
<code>
{
  message: “Please enter otp sent to your email address or mobile no provided.”,
  authurl:“”,
  suggested_auth: “otp” 
}</code>
<br></p>

<p>You then need to call the ​validate pin endpoint
<br></p>
<h4 id='you-then-need-to-call-the-validate-pin-endpoint'>You then need to call the ​validate pin endpoint</h4><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="nt">--request</span> POST <span class="se">\</span>
<span class="nt">--url</span> &lt;BASE_URL&gt;/validate_pin <span class="se">\</span>
<span class="nt">--header</span> <span class="s1">'content-type: application/json'</span> <span class="se">\ </span><span class="nt">--data</span>
‘<span class="o">{</span> “orderreference”: “”, “otp”: “”<span class="o">}</span>’
</code></pre></div><h3 id='http-request-3'>HTTP Request</h3>
<p><code>&lt;BASE_URL&gt;/validate_pin</code></p>
<h3 id='url-parameters-2'>URL Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Definition</th>
</tr>
</thead><tbody>
<tr>
<td>orderreference</td>
<td>Orderreference is the unique transaction orderreference for which otp is being validated</td>
</tr>
<tr>
<td>otp</td>
<td>OTP as provided by user</td>
</tr>
</tbody></table>
<h2 id='step-5-payment-processing'>Step 5 - Payment Processing</h2><h3 id='after-payment-is-processed-user-will-be-redirected-and-notification-is-sent-to-the-url-provided-in-payment_notification_url'>After payment is processed user will be redirected and notification is sent to the url provided in payment_notification_url.</h3><h2 id='step-6-callback-urls'>Step 6 - Callback URLs</h2><h3 id='the-another-pay-after-transaction-s-result-is-received-another-will-calls-the-two-callback-urls-provided-by-merchants'>The Another Pay - After transaction’s result is received Another will calls the two callback URLs provided by ​merchants​.</h3><h3 id='1-notification-url'>1. Notification URL</h3>
<p>After the payment process is complete, Another Pay will <b>​POST​</b> a notification to the URL supplied in the <b> ​payment_notification_url​</b> form element. The result of the payment will be in the body of the POST response.
<br></p>
<h3 id='there-are-two-possible-json-values-returned-success-failure'>There are two possible JSON values returned: ​success / failure​.</h3><h3 id='success'>Success:</h3>
<p><code>{
&quot;id&quot;: SJH1000-56-567565,
&quot;code&quot;: &quot;1232&quot;,
&quot;availed&quot;: true,
“message”: “Transaction successful” “signature”: see below
}</code></p>
<h3 id='failure'>Failure​:</h3>
<p><code>{
&quot;id&quot;: SJH1000-56-567565,
&quot;code&quot;: &quot;1232&quot;,
&quot;availed&quot;: false,
“message”: “Processing error, do not honour”, “signature”: see below
}</code></p>

<p><b>id​:</b> the orderreference <br>
<b>code​:</b> a unique transaction ID created by Another Pay <br>
<b>availed​:</b> boolean true/false indicating success or failure <br>
<b>message:</b>​ “transaction response” <br>
<b>signature</b>​ is for an extra layer of security, to let you know that notification is sent from us.</p>
<h3 id='staging'>Staging:</h3>
<p>SHA1 Hash Hex of string <code>sdhpay-staging=&lt;api_secret&gt;&lt;id&gt;&lt;voucher_code&gt;&lt;availed&gt;</code></p>
<h3 id='live'>Live:</h3>
<p>SHA1 Hash Hex of string <code>sdhpay-live=&lt;api_secret&gt;&lt;id&gt;&lt;voucher_code&gt;&lt;availed&gt;</code></p>
<h3 id='api_secret-can-be-found-from-your-merchant-panel'>api_secret can be found from your merchant panel</h3>
<aside class="info">

Note that this should be valid JSON data. There are quotes on names and values. JSON data can be validated using: ​<a href='https://jsonlint.com'>https://jsonlint.com/</a>
</aside>
<h3 id='2-redirect-url'>2. Redirect URL</h3>
<p>In addition to the notification URL, Another Pay will redirect the browser to the URL that is defined in the payment_redirect_url. <br></p>

<p><b>Success​:</b> ?id=45&amp;code=1232&amp;availed=true <br> 
<b>Failure​:</b> ?id=45&amp;code=1232&amp;availed=false</p>
<h1 id='form-parameter-definitions'>Form Parameter Definitions</h1>
<p>Provided by EMP</p>

<table><thead>
<tr>
<th>Field Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>amount</td>
<td>This is the amount to be charged from card it is passed as - (“amount”:10).</td>
</tr>
<tr>
<td>email</td>
<td>This is the email address of the customer.</td>
</tr>
<tr>
<td>phonenumber</td>
<td>This is the phone number of the customer.</td>
</tr>
<tr>
<td>firstname</td>
<td>This is the first name of the card holder or the customer.</td>
</tr>
<tr>
<td>lastname</td>
<td>This is the last name of the card holder or the customer.</td>
</tr>
<tr>
<td>IP</td>
<td>IP - Internet Protocol. This represents the current IP address of the customer carrying out the transaction.</td>
</tr>
<tr>
<td>txRef</td>
<td>Unique orderreference for transaction</td>
</tr>
<tr>
<td>redirect_url</td>
<td><code>&lt;BASE_URL&gt;/​validate_payment</code></td>
</tr>
<tr>
<td>billingstreet</td>
<td>The street entered for the billing address.</td>
</tr>
<tr>
<td>billingpostcode</td>
<td>The postcode entered for the billing address. We perform the following validation for addresses in the United States. Great Britain and Canada (where &#39;T&#39; represents text A-Z or a-z and ‘N’ represents numbers 0-9)</td>
</tr>
<tr>
<td>billingcountry</td>
<td>The country entered for billing address using ​ISO2A​ f​ ormat</td>
</tr>
</tbody></table>
<h1 id='test-cards'>Test Cards</h1><h2 id='test-cards-2'>Test Cards</h2>
<div class="container">
  <div class="card">
    <h3>Test MasterCard PIN authentication</h3>
    <h6>5531 8866 5214 2950 cvv 564</h6>
    <h6>Expiry: 09/22</h6>
    <h6>Pin 3310</h6>
    <h6>otp 12345</h6>
    
    
    
  </div>
  <div class="card">
    <h3>Test MasterCard PIN authentication</h3>
    <h6>5531 8866 5214 2950 cvv 564</h6>
    <h6>Expiry: 09/22</h6>
    <h6>Pin 3310</h6>
    <h6>otp 12345</h6>
    
    
    
  </div>
  <div class="card">
    <h3>Test MasterCard PIN authentication</h3>
    <h6>5531 8866 5214 2950 cvv 564</h6>
    <h6>Expiry: 09/22</h6>
    <h6>Pin 3310</h6>
    <h6>otp 12345</h6>
    
    
    
  </div>
  <div class="card">
    <h3>Test MasterCard PIN authentication</h3>
    <h6>5531 8866 5214 2950 cvv 564</h6>
    <h6>Expiry: 09/22</h6>
    <h6>Pin 3310</h6>
    <h6>otp 12345</h6>
    
    
    
  </div>
  <div class="card">

    <h3>Test Visa Card 3D-Secure authentication</h3>
      <h6>4187 4274 1556 4246</h6> 
      <h6>cvv: 828</h6>
      <h6>Expiry: 09/21</h6>
      <h6>Pin 3310</h6>
      <h6>otp 12345</h6>
    </div>
  <div class="card">
    
    <h3>Test MasterCard 3DSecure authentication</h3>
    <h6>5438 8980 1456 0229</h6> 
    <h6>cvv: 564</h6>
    <h6>Expiry: 10/20</h6>
    <h6>Pin 3310</h6>
    <h6>otp 12345</h6>
  </div>
  <div class="card">
    <h3>Test Verve Card (PIN)</h3>
    <h6>5061 4604 1012 0223 210</h6>
    <h6> Expiry Month 12</h6>
    <h6>Expiry Year 21</h6>
    <h6>cvv: 780</h6>
    <h6>Pin: 3310</h6>
    <h6>otp 12345</h6>
  </div>
  <div class="card">
    <h3>Test VisaCard 3D-Secure Authentication</h3>
    <h6>4242 4242 4242 4242 </h6>
    <h6>cvv: 812</h6>
    <h6>Expiry: 01/21</h6>
    <h6>Pin 3310</h6>
    <h6>otp 12345</h6>
  </div>
  <div class="card">
    <h3>Test NoAuth Visa Card</h3>
    <h6>4751 7632 3669 9647</h6>
    <h6>Expiry: 09/21</h6>
  </div>
  <div class="card">
    <h3>
      Test Mastercard 3DSecure authentication 2
    </h3>
    <h6>5399 8383 8383 8381</h6>
    <h6>cvv 470</h6>
    <h6>Expiry: 10/22</h6>
    <h6>Pin 3310</h6>
    <h6>otp 12345</h6>
  </div>
   




   





       


  <div class="card">
    <h3>  Test VisaCard (Address Verification)</h3>
    <h6>4556 0527 0417 2643</h6>
    <h6>cvv: 899</h6>
    <h6>Expiry: 01/21</h6>
  </div>

   

  <div class="card">
    <h3> Test card Declined (Address Verification)</h3>
    <h6>5143 0105 2233 9965</h6>
    <h6>cvv 276</h6>
    <h6>Expiry: 08/21</h6>
    <h6>Pin 3310</h6>
  </div>
   

      
   

  <div class="card">
    <h3>Test Card Fraudulent</h3>
    <h6>5590 1317 4329 4314</h6>
    <h6>cvv 887</h6>
    <h6>Expiry: 11/20</h6>
    <h6>Pin 3310</h6>
    <h6>otp 12345</h6>
  </div>

       
   


  <div class="card">
    <h3>Test Card Insufficient Funds</h3>
    <h6>5258 5859 2266 6506</h6>
    <h6> cvv 883</h6>
    <h6>Expiry: 09/21</h6>
    <h6>
  Pin 3310</h6>
    <h6>otp 12345</h6>
  </div>

       




  <div class="card">
    <h3>Pre-authorization Test Card</h3>
    <h6>5377 2836 4507 7450</h6>
    <h6>cvv 789</h6>
    <h6>Expiry: 09/21</h6>
    <h6>Pin 3310</h6>
  </div>
    
   



  <div class="card">
    <h3>Test card - Do Not Honour</h3>
    <h6>5143010522339965</h6>
    <h6>cvv 276</h6>
    <h6>Expiry: 08/21</h6>
    <h6>Pin 3310</h6>
  </div>

       
   



  <div class="card">
    <h3>Test Card - Insufficient Funds</h3>
    <h6>5258585922666506</h6>
    <h6>cvv 883</h6>
    <h6>Expiry: 09/21</h6>
    <h6>Pin 3310</h6>
    <h6>otp 12345</h6>
  </div>
      
   




  <div class="card">
    <h3>
       Test Card - Invalid Transaction
    </h3>
    <h6>5551658157653822</h6>
    <h6>Cvv 276</h6>
    <h6>
      Expiry: 08/21  
    </h6>
  </div>

  <div class="card">
    <h3>Test Card - Restricted Card, Retain Card</h3>
    <h6>5551651630381384</h6>
    <h6>Cvv 276</h6>
    <h6>Expiry: 08/21</h6>
  </div>
     
   


  <div class="card">
    <h3>Test Card - Function Not Permitted to Cardholder</h3>
    <h6>
      5258582054729020
    </h6>
    <h6>Cvv 887</h6>
    <h6>Expiry: 11/20</h6>
  </div>
      
   


  <div class="card">
    <h3>Test Card - Function Not Permitted to Terminal</h3>
    <h6>5258588264565682</h6>
    <h6>Cvv 887</h6>
    <h6>Expiry: 11/20</h6>
  </div>
    
   


  <div class="card">
    <h3>Test Card - Function Not Permitted to Terminal</h3>
    <h6>5258588264565682</h6>
    <h6>Cvv 887</h6>
  </div>

   


   

  <div class="card">
    <h3>Test Card - Transaction Error</h3>
    <h6>5258589130149016</h6>
    <h6>Cvv 887</h6>
    <h6>Expiry: 11/20</h6>
  </div>
</div>
<h1 id='customized-plugins'>Customized Plugins</h1>
<p>For <b>WordPress sites with Woocommerce used as store front​</b>​, we provide a customized plugin for AnotherPay Gateway with both ​Sandbox​ and ​Live​ environment setup.</p>

<p><img src="images/customized_plugins-4310fc8d.png"></p>
<h1 id='errors'>Errors</h1>
<aside class="notice">
This error section is stored in a separate file in <code>includes/_errors.md</code>. Slate allows you to optionally separate out your docs into many files...just save them to the <code>includes</code> folder and add them to the top of your <code>index.md</code>'s frontmatter. Files are included in the order listed.
</aside>

<p>The Kittn API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request -- Your request is invalid.</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized -- Your API key is wrong.</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden -- The kitten requested is hidden for administrators only.</td>
</tr>
<tr>
<td>404</td>
<td>Not Found -- The specified kitten could not be found.</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed -- You tried to access a kitten with an invalid method.</td>
</tr>
<tr>
<td>406</td>
<td>Not Acceptable -- You requested a format that isn&#39;t json.</td>
</tr>
<tr>
<td>410</td>
<td>Gone -- The kitten requested has been removed from our servers.</td>
</tr>
<tr>
<td>418</td>
<td>I&#39;m a teapot.</td>
</tr>
<tr>
<td>429</td>
<td>Too Many Requests -- You&#39;re requesting too many kittens! Slow down!</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error -- We had a problem with our server. Try again later.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable -- We&#39;re temporarily offline for maintenance. Please try again later.</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
          </div>
      </div>
    </div>
  </body>
</html>
